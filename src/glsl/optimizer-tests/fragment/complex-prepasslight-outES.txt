varying highp vec3 xlv_TEXCOORD1;
varying highp vec4 xlv_TEXCOORD0;
uniform highp vec4 unity_LightmapFade;
uniform highp vec4 _ZBufferParams;
uniform highp vec3 _WorldSpaceCameraPos;
uniform samplerCube _ShadowMapTexture;
uniform highp vec4 _ProjectionParams;
uniform sampler2D _LightTextureB0;
uniform samplerCube _LightTexture0;
uniform highp vec4 _LightShadowData;
uniform highp vec4 _LightPositionRange;
uniform highp vec4 _LightPos;
uniform highp mat4 _LightMatrix0;
uniform highp vec4 _LightColor;
uniform highp mat4 _CameraToWorld;
uniform sampler2D _CameraNormalsTexture;
uniform sampler2D _CameraDepthTexture;
void main ()
{
  mediump vec4 res;
  highp float atten;
  mediump vec3 lightDir;
  mediump vec3 normal;
  highp vec2 tmpvar_1;
  tmpvar_1 = (xlv_TEXCOORD0.xy / xlv_TEXCOORD0.w);
  lowp vec4 tmpvar_2;
  tmpvar_2 = texture2D (_CameraNormalsTexture, tmpvar_1);
  normal = normalize (((tmpvar_2.xyz * 2.0) - 1.0));
  lowp float tmpvar_3;
  tmpvar_3 = texture2D (_CameraDepthTexture, tmpvar_1).x;
  highp vec4 tmpvar_4;
  tmpvar_4.w = 1.0;
  tmpvar_4.xyz = ((xlv_TEXCOORD1 * (_ProjectionParams.z / xlv_TEXCOORD1.z)) * 1.0/(((_ZBufferParams.x * tmpvar_3) + _ZBufferParams.y)));
  highp vec3 tmpvar_5;
  tmpvar_5 = (_CameraToWorld * tmpvar_4).xyz;
  highp vec3 tmpvar_6;
  tmpvar_6 = (tmpvar_5 - _LightPos.xyz);
  lightDir = -(normalize (tmpvar_6));
  atten = texture2D (_LightTextureB0, vec2((dot (tmpvar_6, tmpvar_6) * _LightPos.w))).w;
  highp vec4 shadowVals;
  shadowVals.x = dot (textureCube (_ShadowMapTexture, (tmpvar_6 + vec3(0.0078125, 0.0078125, 0.0078125))), vec4(1.0, 0.00392157, 1.53787e-005, 0.0));
  shadowVals.y = dot (textureCube (_ShadowMapTexture, (tmpvar_6 + vec3(-0.0078125, -0.0078125, 0.0078125))), vec4(1.0, 0.00392157, 1.53787e-005, 0.0));
  shadowVals.z = dot (textureCube (_ShadowMapTexture, (tmpvar_6 + vec3(-0.0078125, 0.0078125, -0.0078125))), vec4(1.0, 0.00392157, 1.53787e-005, 0.0));
  shadowVals.w = dot (textureCube (_ShadowMapTexture, (tmpvar_6 + vec3(0.0078125, -0.0078125, -0.0078125))), vec4(1.0, 0.00392157, 1.53787e-005, 0.0));
  bvec4 tmpvar_7;
  tmpvar_7 = lessThan (shadowVals, vec4(((length (tmpvar_6) * _LightPositionRange.w) * 0.97)));
  highp vec4 tmpvar_8;
  tmpvar_8 = _LightShadowData.xxxx;
  float tmpvar_9;
  if (tmpvar_7.x) {
    tmpvar_9 = tmpvar_8.x;
  } else {
    tmpvar_9 = 1.0;
  };
  float tmpvar_10;
  if (tmpvar_7.y) {
    tmpvar_10 = tmpvar_8.y;
  } else {
    tmpvar_10 = 1.0;
  };
  float tmpvar_11;
  if (tmpvar_7.z) {
    tmpvar_11 = tmpvar_8.z;
  } else {
    tmpvar_11 = 1.0;
  };
  float tmpvar_12;
  if (tmpvar_7.w) {
    tmpvar_12 = tmpvar_8.w;
  } else {
    tmpvar_12 = 1.0;
  };
  vec4 tmpvar_13;
  tmpvar_13.x = tmpvar_9;
  tmpvar_13.y = tmpvar_10;
  tmpvar_13.z = tmpvar_11;
  tmpvar_13.w = tmpvar_12;
  highp vec4 tmpvar_14;
  tmpvar_14.w = 1.0;
  tmpvar_14.xyz = tmpvar_5;
  highp float tmpvar_15;
  tmpvar_15 = ((atten * dot (tmpvar_13, vec4(0.25, 0.25, 0.25, 0.25))) * textureCube (_LightTexture0, (_LightMatrix0 * tmpvar_14).xyz).w);
  atten = tmpvar_15;
  res.xyz = (_LightColor.xyz * (max (0.0, dot (lightDir, normal)) * tmpvar_15));
  mediump vec3 c;
  c = _LightColor.xyz;
  res.w = ((pow (max (0.0, dot (normalize ((lightDir - normalize ((tmpvar_5 - _WorldSpaceCameraPos)))), normal)), (tmpvar_2.w * 128.0)) * clamp (tmpvar_15, 0.0, 1.0)) * dot (c, vec3(0.22, 0.707, 0.071)));
  highp vec4 tmpvar_16;
  tmpvar_16 = (res * clamp ((1.0 - ((tmpvar_4.z * unity_LightmapFade.z) + unity_LightmapFade.w)), 0.0, 1.0));
  res = tmpvar_16;
  gl_FragData[0] = exp2 (-(tmpvar_16));
}

